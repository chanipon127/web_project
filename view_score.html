<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <title>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</title>
  <style>
    body {
      font-family: sans-serif;
      line-height: 1.6;
      margin: 20px;
      background-color: #f5f5f5;
    }

    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1,
    h2,
    h3 {
      color: #333;
    }

    .info-section {
      background-color: #f9f9f9;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }

    .info-section p {
      margin: 8px 0;
    }

    pre {
      background: #eee;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 300px;
      overflow-y: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background-color: #4c65af;
      color: white;
      font-weight: bold;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    /* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå feedback ‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
    td:last-child {
      white-space: pre-wrap;
      word-wrap: break-word;
      min-width: 300px;
      max-width: 500px;
    }

    .btn-back {
      padding: 10px 20px;
      background: #4c65af;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 20px;
      font-size: 16px;
    }

    .btn-back:hover {
      background: #3a4a8f;
    }

    .score {
      font-weight: bold;
      color: #2e7d32;
      font-size: 18px;
    }

    .status {
      font-weight: bold;
      padding: 4px 12px;
      border-radius: 4px;
      display: inline-block;
    }

    .status.checked {
      background-color: #c8e6c9;
      color: #2e7d32;
    }

    .status.unchecked {
      background-color: #ffcdd2;
      color: #c62828;
    }

    /* Loading Spinner */
    .loading {
      text-align: center;
      padding: 50px;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #4c65af;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .error-message {
      color: #c62828;
      padding: 20px;
      background-color: #ffcdd2;
      border-radius: 4px;
      margin: 20px 0;
    }

    /* Responsive */
    @media (max-width: 768px) {
      table {
        font-size: 14px;
      }

      th,
      td {
        padding: 8px;
      }

      td:last-child {
        min-width: 200px;
      }
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
    .score-cell {
      text-align: center;
      font-weight: bold;
    }

    .score-ai {
      color: #1976d2;
    }

    .score-teacher {
      color: #388e3c;
    }
  </style>
</head>

<body>
  <div class="container" id="mainContainer">
    <div class="loading">
      <div class="spinner"></div>
      <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
    </div>
  </div>

  <script>
    // ========== ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API ==========
    const API_BASE_URL = 'http://127.0.0.1:8000';

    // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö ==========
    function goBack() {
      window.location.href = "check_exam.html";
    }

    // ========== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö answer_id ==========
    const urlParams = new URLSearchParams(window.location.search);
    const answerId = urlParams.get("answer_id");

    if (!answerId) {
      showError("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    } else {
      loadAnswer(answerId);
    }

    function showError(title, message) {
      document.getElementById('mainContainer').innerHTML = `
        <button class="btn-back" onclick="goBack()">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <div class="error-message">
          <h2>‚ö†Ô∏è ${title}</h2>
          <p>${message}</p>
        </div>
      `;
    }

    // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏°‡∏û‡πÄ‡∏Å‡∏ì‡∏ë‡πå AI ‡∏Å‡∏±‡∏ö s1-s13 (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏)
    function getCriteriaMapping() {
      return {
        "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç": "s1",
        "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏¢‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°": "s3",
        "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥": "s4",
        "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2 - ‡∏Ñ‡∏≥‡∏ö‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô": "s7",
        "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô": "s10"
      };
    }

    async function loadAnswer(answerId) {
      try {
        const res = await fetch(`${API_BASE_URL}/api/view-score/${answerId}`);

        if (!res.ok) {
          throw new Error(`HTTP ${res.status}: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ`);
        }

        const data = await res.json();

        console.log("=== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å API ===");
        console.log("data:", data);
        console.log("description (raw):", data.description);
        console.log("teacher_scores (raw):", data.teacher_scores);

        const container = document.getElementById('mainContainer');
        container.innerHTML = `
      <button class="btn-back" onclick="goBack()">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
        </svg>
        ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
      </button>

      <h1>üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>

      <div class="info-section">
        <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        <div class="info-grid">
          <div class="info-item">
            <strong>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong>
            <span id="studentId">-</span>
          </div>
          <div class="info-item">
            <strong>‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong>
            <span id="groupId">-</span>
          </div>
          <div class="info-item">
            <strong>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</strong>
            <span id="examYear">-</span>
          </div>
          <div class="info-item">
            <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong>
            <span id="status" class="status">-</span>
          </div>
          <div class="info-item">
            <strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° AI:</strong>
            <span id="score" class="score">0</span>
          </div>
        </div>
      </div>

      <h2>üìù ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
      <div class="info-section">
        <strong>‡∏Ç‡πâ‡∏≠ 1: ‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏°‡∏≤</strong>
        <div class="essay-box" id="essayText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>

        <strong style="display:block; margin-top:20px;">‡∏Ç‡πâ‡∏≠ 2: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå/‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</strong>
        <div class="essay-box" id="essayAnalysis">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
      </div>

      <h3>üìä ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</h3>
      <table>
        <thead>
          <tr>
            <th style="width: 350px;">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
            <th class="ai-header" style="width: 100px;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô AI</th>
            <th class="teacher-header" style="width: 100px;">‡∏Ñ‡∏£‡∏π 1</th>
            <th class="teacher-header" style="width: 100px;">‡∏Ñ‡∏£‡∏π 2</th>
            <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
          </tr>
        </thead>
        <tbody id="feedbackTable">
          <tr><td colspan="5" style="text-align:center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td></tr>
        </tbody>
      </table>
    `;

        // ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
        document.getElementById("studentId").textContent = data.student_id || "-";
        document.getElementById("groupId").textContent = data.group_id || "-";
        document.getElementById("examYear").textContent = data.exam_year || "-";

        const statusElement = document.getElementById("status");
        statusElement.textContent = data.status || "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à";
        statusElement.className = "status " + (data.status === '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß' ? 'checked' : 'unchecked');

        document.getElementById("score").textContent = data.score != null ? data.score : "0";
        document.getElementById("essayText").textContent = data.essay_text || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
        document.getElementById("essayAnalysis").textContent = data.essay_analysis || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";

        // ========== ‡πÅ‡∏õ‡∏•‡∏á description ==========
        let description = {};
        try {
          if (data.description) {
            if (typeof data.description === 'string') {
              description = JSON.parse(data.description);
            } else if (typeof data.description === 'object') {
              description = data.description;
            }
          }
          console.log("‚úÖ Parsed description:", description);
        } catch (e) {
          console.error("‚ùå Error parsing description:", e);
          description = {};
        }

        // ========== ‡πÅ‡∏õ‡∏•‡∏á teacher_scores ==========
        let teacherScores = {};
        try {
          if (data.teacher_scores) {
            if (typeof data.teacher_scores === 'string') {
              teacherScores = JSON.parse(data.teacher_scores);
            } else if (typeof data.teacher_scores === 'object') {
              teacherScores = data.teacher_scores;
            }
          }
          console.log("‚úÖ Parsed teacherScores:", teacherScores);
        } catch (e) {
          console.error("‚ùå Error parsing teacher_scores:", e);
          teacherScores = {};
        }

        // ========== ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á ==========
        const feedbackTable = document.getElementById("feedbackTable");
        feedbackTable.innerHTML = "";

        const criteriaOrder = [
          "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
          "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏¢‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°",
          "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1 - ‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥",
          "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2 - ‡∏Ñ‡∏≥‡∏ö‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô",
          "‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô",
          "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1",
          "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2",
          "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (15 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)"
        ];

        const mapping = getCriteriaMapping();
        let totalAI = 0;
        let totalTeacher1 = 0;
        let totalTeacher2 = 0;

        criteriaOrder.forEach(key => {
          if (description[key] !== undefined) {
            const item = description[key];
            let aiScore = "-";
            let details = "";

            // ========== ‡∏î‡∏∂‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô AI ==========
            if (typeof item === 'number') {
              aiScore = item;
              if (key.includes("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°")) {
                totalAI += parseFloat(item) || 0;
              }
            } else if (item && item.score !== undefined && item.score !== null) {
              aiScore = item.score;
              if (!key.includes("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°")) {
                totalAI += parseFloat(aiScore) || 0;
              }
            } else if (item && item.‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° !== undefined && item.‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° !== null) {
              aiScore = item.‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°;
              totalAI += parseFloat(aiScore) || 0;
            }

            // ========== ‡∏î‡∏∂‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏£‡∏π ==========
            let teacher1 = "-";
            let teacher2 = "-";

            if (mapping[key]) {
              const sKey = mapping[key];

              if (teacherScores && typeof teacherScores === 'object') {
                const t1 = teacherScores.teacher1?.[sKey];
                const t2 = teacherScores.teacher2?.[sKey];

                if (t1 !== null && t1 !== undefined && t1 !== "") {
                  const t1Val = parseFloat(t1);
                  if (!isNaN(t1Val)) {
                    teacher1 = t1Val.toFixed(2);
                    if (!key.includes("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°")) {
                      totalTeacher1 += t1Val;
                    }
                  }
                }

                if (t2 !== null && t2 !== undefined && t2 !== "") {
                  const t2Val = parseFloat(t2);
                  if (!isNaN(t2Val)) {
                    teacher2 = t2Val.toFixed(2);
                    if (!key.includes("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°")) {
                      totalTeacher2 += t2Val;
                    }
                  }
                }
              }

              console.log(`üìù ${key} -> ${sKey}: AI=${aiScore}, T1=${teacher1}, T2=${teacher2}`);
            }

            // ========== ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ==========
            if (typeof item === 'object' && item !== null) {
              details = Object.entries(item)
                .filter(([k, v]) => k !== 'score' && k !== '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°')
                .map(([k, v]) => {
                  if (typeof v === 'object') {
                    return `${k}: ${JSON.stringify(v)}`;
                  }
                  return `${k}: ${v}`;
                })
                .join('\n');
            }

            // ========== ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß ==========
            const row = document.createElement("tr");
            const isSum = key.includes("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°");

            row.innerHTML = `
          <td><strong>${key}</strong></td>
          <td class="score-cell score-ai">${aiScore}</td>
          <td class="score-cell score-teacher">${teacher1}</td>
          <td class="score-cell score-teacher">${teacher2}</td>
          <td class="detail-cell">${details || '-'}</td>
        `;

            if (isSum) {
              row.style.background = "#f0f8ff";
              row.style.fontWeight = "bold";
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ß‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á
            if (aiScore === "-" && teacher1 === "-" && teacher2 === "-") {
              console.warn(`‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ${key}`);
            }

            feedbackTable.appendChild(row);
          }
        });

        console.log("üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:", {
          totalAI: totalAI.toFixed(2),
          totalTeacher1: totalTeacher1.toFixed(2),
          totalTeacher2: totalTeacher2.toFixed(2)
        });

      } catch (error) {
        console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
        showError("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", error.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
      }
    }
  </script>
</body>

</html>
